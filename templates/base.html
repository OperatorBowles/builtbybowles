<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>{% block title %}{% endblock %}</title>
	<link rel="canonical" href="/" />
	<link rel="shortcut icon" href="/static/img/favicon.ico">
	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">
	<link href="/static/light.css" rel="stylesheet">
</head>
<body data-layout="fluid">
	<div class="wrapper">
		<div class="main">
			<nav class="navbar navbar-expand navbar-light navbar-bg">
				<a href="/"><span class="align-middle me-3">Built by Bulls</span></a>
				<ul class="navbar-nav navbar-align">
					<li class="nav-item dropdown">
						<a class="nav-icon dropdown-toggle" data-bs-toggle="modal" data-bs-target="#new-workout">
							<div class="position-relative">
								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-activity align-middle me-2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg>
							</div>
						</a>
						
					</li>
					<li class="nav-item dropdown">
						<a class="nav-icon dropdown-toggle" data-bs-toggle="modal" data-bs-target="#new-weight">
							<div class="position-relative">
								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-heart align-middle me-2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
							</div>
						</a>
						
					</li>
					<li class="nav-item dropdown">
						<a class="nav-icon dropdown-toggle" data-bs-toggle="modal" data-bs-target="#centeredModalSuccess">
							<div class="position-relative">
								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-target align-middle me-2"><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><circle cx="12" cy="12" r="2"></circle></svg>
							</div>
						</a>
						
					</li>
					
					<li class="nav-item dropdown">
						<a class="nav-icon dropdown-toggle" href="#" data-bs-toggle="dropdown">
							<div class="position-relative">
								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-settings align-middle me-2"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
							</div>
						</a>
						<div class="dropdown-menu dropdown-menu-end">
							<a class="dropdown-item" href="/settings">Settings & Privacy</a>
							<a class="dropdown-item" href="/signout">Sign out</a>
						</div>
					</li>
				</ul>
			</nav>
            {% block body %}

            {% endblock %}
			<footer class="footer">
				<div class="container-fluid">
					<div class="row text-muted">
						<div class="col-6 text-end">
							<p class="mb-0">
								&copy; 2021 - <a href="index.html" class="text-muted">Built by Bulls</a>
							</p>
						</div>
					</div>
				</div>
			</footer>
		</div>
	</div>
	<script src="/static/js/app.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script>
	<script>
		document.addEventListener("DOMContentLoaded", function() {
			$("#datetimepicker-dashboard").datetimepicker({
				inline: true,
				sideBySide: false,
				format: "L"
			});
		});
	</script>
	
	<script>
		document.addEventListener("DOMContentLoaded", function() {
			$("#datatables-dashboard-projects").DataTable({
				pageLength: 6,
				lengthChange: false,
				bFilter: false,
				autoWidth: false
			});
		});
	</script>
	<script>
		document.addEventListener("DOMContentLoaded", function() {
			{% if goals %}
				var gCalories = Number({{ goals.calories }});
				document.getElementById("calories").value=gCalories;

				var gCarbs = Math.round(((Number({{ goals.carbs}}) * 4) / gCalories) * 100);
				document.getElementById("carbPerc").textContent=gCarbs;
				document.getElementById("carbGrams").textContent=Number({{ goals.carbs }});
				document.getElementById("rngCarb").value=gCarbs;

				var gProtein = Math.round(((Number({{ goals.protein}}) * 4) / gCalories) * 100);
				document.getElementById("proteinPerc").textContent=gProtein;
				document.getElementById("proteinGrams").textContent=Number({{ goals.protein }});
				document.getElementById("rngProtein").value=gProtein;

				var gFats = Math.round(((Number({{ goals.fats}}) * 8) / gCalories) * 100);
				document.getElementById("fatPerc").textContent=gFats;
				document.getElementById("fatGrams").textContent=Number({{ goals.fats }});
				document.getElementById("rngFat").value=gFats;

			{% else %}
			{% endif %}
		});

		{% if goals %}
			var carbGoal = Number({{ goals.calories }}/4);
			var proteinGoal = Number({{ goals.calories }}/4);
			var fatGoal = Number({{ goals.calories }}/8);

			var curCarbVal = Number(document.getElementById("carbPerc").textContent/100);
			var curProteinVal = Number(document.getElementById("proteinPerc").textContent/100);
			var curFatVal = Number(document.getElementById("fatPerc").textContent/100);
		{% else %}
			var curCarbVal = .5;
			var curProteinVal = .5;
			var curFatVal = .5;
		{% endif %}

		const calories = document.getElementById("calories");
		calories.addEventListener('change', updateValue);
		var calGoal = 0;

		function updateValue(e) {
			calGoal = e.target.value;
			carbGoal = Math.ceil(calGoal/4);
			proteinGoal = Math.ceil(calGoal/4);
			fatGoal = Math.ceil(calGoal/8);	

			document.getElementById("carbGrams").textContent=Math.ceil(carbGoal*curCarbVal);
			document.getElementById("proteinGrams").textContent=Math.ceil(proteinGoal*curProteinVal);
			document.getElementById("fatGrams").textContent=Math.ceil(fatGoal*curFatVal);
		};

		function updateCarbInput(val) {
			document.getElementById("carbPerc").textContent=val;
			document.getElementById("carbGrams").textContent=Math.ceil(carbGoal*(val/100));
			validateEntries();
		};
		function updateProteinInput(val) {
			document.getElementById("proteinPerc").textContent=val;
			document.getElementById("proteinGrams").textContent=Math.ceil(proteinGoal*(val/100));
			validateEntries();
		};
		function updateFatInput(val) {
			document.getElementById("fatPerc").textContent=val;
			document.getElementById("fatGrams").textContent=Math.ceil(fatGoal*(val/100));
			validateEntries();
		};

		function validateEntries() {
			var totalPer = (Number(document.getElementById("carbPerc").textContent) + Number(document.getElementById("proteinPerc").textContent) + Number(document.getElementById("fatPerc").textContent));
			if (totalPer == 100) {
				document.getElementById("submitGoal").disabled = false;
			} else {
				document.getElementById("submitGoal").disabled = true;
			};
		};
		
	</script>
	<script>
		document.getElementById("submitGoal").addEventListener('click', function() {

			$.ajax({
				url: "/tracking",
				type: "POST",
				data:{id: id},
				success: function(data) {
					if (data.Success){
						console.log("Succesfully logged goals");
					};
				}
			})
		});
	</script>


	{% block js %}
	{% endblock %}
</body>

</html>